package pkg484groupproj;

import java.text.DecimalFormat;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import java.util.*;

public class CustSale {
    
    //DataFields
    private String saleID; 
    private static int saleIDCount = 0; 
    //private String saleCategory; 
    private String saleDate;
    private Customer customer;
    private boolean isMem;
    private String memStat;
    private Store store;
    private Employee employee;
    private double subtotal;
    private double tax;
    private double totalCost;
    
    //Fromatter for money figures
    DecimalFormat formatter = new DecimalFormat("#0.00");
    
    private ArrayList<Product> saleProducts = new ArrayList();
    
    //Constructor for reading in from CustSaleForm
    public CustSale(String saleDate, Store store, Employee employee, 
            String memStat, ArrayList saleProducts) {
        this.saleDate = saleDate;
        this.store = store;
        this.employee = employee;
        this.memStat = memStat;
        this.saleProducts = saleProducts;
        
        if(memStat.contains("Yes"))
        {
            this.isMem = true;
        }
        else
        {
            this.isMem = false;
        }
        
        for(int i=0; i<this.saleProducts.size();i++)
        {
            //Give Thrifty Members 5% discount
            if(this.isMem == true)
            {
                this.subtotal += ((this.saleProducts.get(i).getPrice()) *.95);
            }
            else if(this.isMem == false)
            {
                this.subtotal += this.saleProducts.get(i).getPrice();
            }
        }
        
        this.tax = (this.subtotal * .053);
        this.totalCost = (this.subtotal + this.tax);
        this.saleID = "Sale" + saleIDCount++; 
        
    }
    
    public CustSale(String saleDate, Store store, Employee employee,
            Customer customer, ArrayList saleProducts) {
        this.saleDate = saleDate;
        this.store = store;
        this.employee = employee;
        this.customer = customer;
        this.saleProducts = saleProducts;
        
        for(int i=0; i<this.saleProducts.size();i++)
        {
            this.subtotal += this.saleProducts.get(i).getPrice();
        }
        
        this.tax = (this.subtotal * .053);
        this.totalCost = (this.subtotal + this.tax);
        this.saleID = "Sale" + saleIDCount++; 
        
    }
    
    public static int getSaleIDCount()
    {
        return saleIDCount;
    }
    
    public void setSaleDate(String saleDate) {
        this.saleDate = saleDate; 
    } 
    public String getSaleDate() {
        return saleDate; 
    }
    public void setIsMem(boolean isMem)
    {
        this.isMem = isMem;
    }
    public boolean getIsMem()
    {
        return this.isMem;
    }
    public void setSubtotal(double subtotal) {
        this.subtotal = subtotal; 
    }
    public double getSubtotal() {
        return this.subtotal; 
    }
    
    @Override
    public String toString() {
        return "Sale Number: " + this.saleID + "\nDate: " + this.saleDate.toString()
                + "\nSubtotal: $" + formatter.format(this.subtotal) 
                + "\nTax: $" + formatter.format(this.tax)
                + "\nTotal: $" + formatter.format(this.totalCost); 
    }
}
